
// build-prayer-data.js

const fs = require('fs');
const path = require('path');

// Define the source directory and the output file
const prayersDir = path.join(__dirname, 'prayer/prayer-database');
const outputFile = path.join(__dirname, 'prayer/prayer-content/compiled-prayer-data.ts');

const allPrayerData = {};

console.log('🔍 Starting to scan prayer directories...');

// Read all subdirectories (e.g., '40-mem-prayers')
fs.readdirSync(prayersDir).forEach(subDir => {
    const subDirPath = path.join(prayersDir, subDir);
    if (fs.statSync(subDirPath).isDirectory()) {
        
        // Read all JSON files within the subdirectory
        fs.readdirSync(subDirPath).forEach(file => {
            if (path.extname(file) === '.json') {
                const filePath = path.join(subDirPath, file);
                const fileContent = fs.readFileSync(filePath, 'utf-8');
                const jsonData = JSON.parse(fileContent);
                
                // The key in the JSON file (e.g., "40-0rwa")
                const prayerId = Object.keys(jsonData)[0];
                if (prayerId) {
                    console.log(`✅ Processing prayer: ${prayerId}`);
                    allPrayerData[prayerId] = jsonData[prayerId];
                }
            }
        });
    }
});

// Create the TypeScript file content
const fileContent = `// This file is auto-generated by build-prayer-data.js. Do not edit manually.\n
export const detailedPrayerData: { [key: string]: any } = ${JSON.stringify(allPrayerData, null, 2)};
`;

// Write the content to the output file
fs.writeFileSync(outputFile, fileContent);

console.log(`\n🎉 Success! Compiled ${Object.keys(allPrayerData).length} prayers into ${outputFile}`);